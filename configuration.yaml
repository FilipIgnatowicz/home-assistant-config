homeassistant:

  name: Home
  latitude: !secret home_lat
  longitude: !secret home_long
  elevation: 260
  unit_system: metric
  time_zone: Europe/Prague
  customize: !include customize.yaml
  whitelist_external_dirs:
    - /share
#  auth_providers:
# airport worked with this
#    - type: trusted_networks
#      trusted_networks:
#        - !secret trusted_network1
# uncomment for iOS device add, other option for airport (seems to work with only this, but then the web doesn't seem to login with normal auth) 
#    - type: legacy_api_password
#      api_password: !secret API_pass

group: !include groups.yaml

automation: !include_dir_merge_list automations/

script: !include scripts.yaml

sensor: !include sensors.yaml

binary_sensor: !include binary_sensors.yaml

zone: !include zones.yaml

config:

hassio:

cloud:

system_health:

api:

conversation:
    
logbook:

map:

sun:

python_script:

stream:

lovelace:

  mode: yaml

  resources:

    - url: /hacsfiles/vertical-stack-in-card/vertical-stack-in-card.js
      type: js
    - url: /hacsfiles/button-card/button-card.js
      type: module
    - url: /hacsfiles/lovelace-card-tools/card-tools.js
      type: module
    - url: /hacsfiles/mini-media-player/mini-media-player-bundle.js
      type: module
    - url: /hacsfiles/lovelace-layout-card/layout-card.js
      type: module
    - url: /hacsfiles/calendar-card/calendar-card.js
      type: js
    - url: /hacsfiles/mini-graph-card/mini-graph-card-bundle.js
      type: module
    - url: /hacsfiles/lovelace-slider-entity-row/slider-entity-row.js
      type: module
    - url: /hacsfiles/secondaryinfo-entity-row/secondaryinfo-entity-row.js
      type: js
    - url: /hacsfiles/simple-thermostat/simple-thermostat.js
      type: module
    - url: /hacsfiles/air-visual-card/air-visual-card.js
      type: js
    - url: /hacsfiles/custom-header/custom-header.js
      type: module
    - url: /hacsfiles/lovelace-weather-card-chart/weather-card-chart.js
      type: module
    - url: /hacsfiles/lovelace-card-mod/card-mod.js
      type: module
    - url: /hacsfiles/lovelace-home-feed-card/lovelace-home-feed-card.js
      type: js
    - url: /hacsfiles/search-card/search-card.js
      type: module
    - url: /hacsfiles/lovelace-state-switch/state-switch.js
      type: module
    - url: /hacsfiles/swipe-card/swipe-card.js
      type: module
    - url: /hacsfiles/circle-sensor-card/circle-sensor-card.js
      type: module
    - url: /hacsfiles/lovelace-card-preloader/lovelace-card-preloader.js
      type: module 
    - url: /hacsfiles/decluttering-card/decluttering-card.js
      type: module

frontend:
  themes: !include_dir_merge_named themes
#  themes: !include themes.yaml
  javascript_version: auto
  extra_module_url:
    - /hacsfiles/custom-sidebar/custom-sidebar.js

mobile_app:

#uncomment for iOS device add
discovery:
#  ignore:
#    - plex_mediaserver
    
http:
  base_url: https://ykzeuvypwjk18i8n16yph2po160resx0.ui.nabu.casa/
#uncomment for iOS device add
#  api_password: !secret API_pass

#uncomment to re-enable public ssl access
#  ssl_certificate: !secret cer_dir
#  ssl_key: !secret key_dir
#  base_url: !secret my_host+port

updater:

# include_used_components: true
# discovery:
# discovery:

#tts:
#
#  - platform: google

#hacs:
#  token: !secret hacs_token

logger:

  default: debug
  logs:
    homeassistant.components.mqtt: warn
    homeassistant.components.websocket_api: warn
    homeassistant.components.deluge_client: warn
    homeassistant.components.zwave: warn
    homeassistant.components.openzwave: warn
    homeassistant.components.libopenzwave: warn
    homeassistant.components.http.view: warn
    libopenzwave: warn
    openzwave: warn
    zwave: warn
    homeassistant.components.evohome_rf: debug
    evohome: debug
#    hass_nabucasa: debug
#    homeassistant.components.cloud: debug
#    homeassistant.components.nest: debug
#    homeassistant.components.sensor.nest: debug
#    sseclient: debug
#    homeassistant.components.camera: debug
#    homeassistant.components.sensor.imap_email_content: debug
#    homeassistant.components.imap_email_content: debug
#    homeassistant.components.sensor: debug

history: !include history_exclude

recorder: !include recorder_exclude

#custom_updater:
#  track:
#    - cards
#    - components
#    - python_scripts
#  component_urls:
#    - https://raw.githubusercontent.com/pnbruckner/homeassistant-config/master/custom_components.json
#  python_script_urls:
#    - https://raw.githubusercontent.com/pnbruckner/homeassistant-config/master/python_scripts.json
#  card_urls:
#    - https://raw.githubusercontent.com/rdehuyss/homeassistant-lovelace-google-calendar-card/master/custom_updater.json
#    - https://raw.githubusercontent.com/kalkih/mini-media-player/master/tracker.json
#    - https://raw.githubusercontent.com/kuuji/button-card/master/tracker.json
#    - https://raw.githubusercontent.com/nervetattoo/simple-thermostat/master/tracker.json
#    - https://raw.githubusercontent.com/sgttrs/lovelace-weather-card-chart/master/custom-updater.json
#    - https://raw.githubusercontent.com/kalkih/mini-graph-card/master/tracker.json    
#    - https://raw.githubusercontent.com/MizterB/lovelace-secondaryinfo-entity-row/master/custom_cards.json

switch:

  - platform: command_line
    switches:
      shuffle:
        friendly_name:  Shuffle
        command_on: !secret shuffle_on_cmd
        command_off: !secret shuffle_off_cmd

  - platform: template
    switches:
      camera_sebs_room_email:
        value_template: "{{ is_state_attr('camera.sebs_room', 'email_enabled', true) }}"
        turn_on:
          service: camera.enable_email
          data:
            entity_id: camera.sebs_room
        turn_off:
          service: camera.disable_email
          data:
            entity_id: camera.sebs_room
        icon_template: >-
          {% if is_state_attr('camera.sebs_room', 'email_enabled', true) %}
            mdi:email
          {% else %}
            mdi:email-outline
          {% endif %}
            
      camera_sebs_room_ftp:
        value_template: "{{ is_state_attr('camera.sebs_room', 'ftp_enabled', true) }}"
        turn_on:
          service: camera.enable_ftp
          data:
            entity_id: camera.sebs_room
        turn_off:
          service: camera.disable_ftp
          data:
            entity_id: camera.sebs_room
        icon_template: >-
          {% if is_state_attr('camera.sebs_room', 'ftp_enabled', true) %}
            mdi:filmstrip
          {% else %}
            mdi:filmstrip-off
          {% endif %}
          
      camera_sebs_room_ir_lights:
        value_template: "{{ is_state_attr('camera.sebs_room', 'ir_lights_enabled', true) }}"
        turn_on:
          service: camera.enable_ir_lights
          data:
            entity_id: camera.sebs_room
        turn_off:
          service: camera.disable_ir_lights
          data:
            entity_id: camera.sebs_room
        icon_template: >-
          {% if is_state_attr('camera.sebs_room', 'ir_lights_enabled', true) %}
            mdi:flashlight
          {% else %}
            mdi:flashlight-off
          {% endif %}
          
evohome:

  username: !secret my_email
  password: !secret hass_pass
  location_idx: 0
  scan_interval: 360 

media_player:

  - platform: itunes
    host: !secret itunes_ip

ios:
  push:
    categories:
      - name: Trash
        identifier: 'trash'
        actions:
          - identifier: 'TOOK_TRASH_OUT'
            title: 'I took it out.'
            activationMode: 'background'
            authenticationRequired: false
            destructive: false
            behavior: 'default'
          - identifier: 'SNOOZE_ALERT'
            title: 'Remind me later'
            activationMode: 'background'
            authenticationRequired: false
            destructive: false
            behavior: 'default'
            
nest:

  client_id: !secret nest_client_id
  client_secret: !secret nest_client_secret
  sensors:
    monitored_conditions:
      - 'co_status'
      - 'smoke_status'
      - 'battery_health'
      - 'color_status'

camera:

#  - platform: generic
#    name: Syno Stream Front
#    still_image_url: !secret front_still_url
#    stream_source: !secret syno_front_url
#    framerate: 4
#    
#  - platform: generic
#    name: Cam Substream Front
#    still_image_url: !secret front_still_url
#    stream_source: !secret front_substream_url
#    framerate: 4
#    

  - platform: generic
    name: Front Stream
    still_image_url: !secret front_still_url
    stream_source: !secret front_main_stream_url
    framerate: 4

  - platform: generic
    name: Back Stream
    still_image_url: !secret back_still_url
    stream_source: !secret back_main_stream_url
    framerate: 4

  - platform: generic
    name: Left Stream
    still_image_url: !secret left_still_url
    stream_source: !secret left_main_stream_url
    framerate: 4

  - platform: generic
    name: Right Stream
    still_image_url: !secret right_still_url
    stream_source: !secret right_main_stream_url
    framerate: 4

#Frigate v.5 cameras 

  - name: Right Last Person
    platform: mqtt
    topic: !secret frigate_cam2_topic

  - name: Left Last Person
    platform: mqtt
    topic: !secret frigate_cam4_topic

  - name: Front Last Person
    platform: mqtt
    topic:  !secret frigate_cam3_topic

  - name: Back Last Person
    platform: mqtt
    topic: !secret frigate_cam1_topic

#Frigate v.2 cameras

#  - name: Right Last Person
#    platform: generic
#    still_image_url: !secret right_best_url
#
#  - name: Left Last Person
#    platform: generic
#    still_image_url: !secret left_best_url
#
#  - name: Front Last Person
#    platform: generic
#    still_image_url: !secret front_best_url
#
#  - name: Back Last Person
#    platform: generic
#    still_image_url: !secret back_best_url

# Synology Cameras

#  - platform: synology
#    url: !secret synology_int_url
#    username: !secret syn_uname
#    password: !secret hass_pass
#    timeout: 120




#    verify_ssl: False


  - name: cam1
    platform: mqtt
    topic: !secret frigate_cam1_topic
  - platform: local_file
    name: cam1_history1
    file_path: /config/www/cam1/1.jpg       
  - platform: local_file
    name: cam1_history2
    file_path: /config/www/cam1/2.jpg        
  - platform: local_file
    name: cam1_history3
    file_path: /config/www/cam1/3.jpg       
  - platform: local_file
    name: cam1_history4
    file_path: /config/www/cam1/4.jpg       
  - platform: local_file
    name: cam1_history5
    file_path: /config/www/cam1/5.jpg       
  - platform: local_file
    name: cam1_history6
    file_path: /config/www/cam1/6.jpg       
  - platform: local_file
    name: cam1_history7
    file_path: /config/www/cam1/7.jpg       
  - platform: local_file
    name: cam1_history8
    file_path: /config/www/cam1/8.jpg       
  - platform: local_file
    name: cam1_history9
    file_path: /config/www/cam1/9.jpg       
  - platform: local_file
    name: cam1_history10
    file_path: /config/www/cam1/10.jpg           

  - name: cam2
    platform: mqtt
    topic: !secret frigate_cam2_topic
  - platform: local_file
    name: cam2_history1
    file_path: /config/www/cam2/1.jpg       
  - platform: local_file
    name: cam2_history2
    file_path: /config/www/cam2/2.jpg        
  - platform: local_file
    name: cam2_history3
    file_path: /config/www/cam2/3.jpg       
  - platform: local_file
    name: cam2_history4
    file_path: /config/www/cam2/4.jpg       
  - platform: local_file
    name: cam2_history5
    file_path: /config/www/cam2/5.jpg       
  - platform: local_file
    name: cam2_history6
    file_path: /config/www/cam2/6.jpg       
  - platform: local_file
    name: cam2_history7
    file_path: /config/www/cam2/7.jpg       
  - platform: local_file
    name: cam2_history8
    file_path: /config/www/cam2/8.jpg       
  - platform: local_file
    name: cam2_history9
    file_path: /config/www/cam2/9.jpg       
  - platform: local_file
    name: cam2_history10
    file_path: /config/www/cam2/10.jpg           

  - name: cam3
    platform: mqtt
    topic: !secret frigate_cam3_topic
  - platform: local_file
    name: cam3_history1
    file_path: /config/www/cam3/1.jpg       
  - platform: local_file
    name: cam3_history2
    file_path: /config/www/cam3/2.jpg        
  - platform: local_file
    name: cam3_history3
    file_path: /config/www/cam3/3.jpg       
  - platform: local_file
    name: cam3_history4
    file_path: /config/www/cam3/4.jpg       
  - platform: local_file
    name: cam3_history5
    file_path: /config/www/cam3/5.jpg       
  - platform: local_file
    name: cam3_history6
    file_path: /config/www/cam3/6.jpg       
  - platform: local_file
    name: cam3_history7
    file_path: /config/www/cam3/7.jpg       
  - platform: local_file
    name: cam3_history8
    file_path: /config/www/cam3/8.jpg       
  - platform: local_file
    name: cam3_history9
    file_path: /config/www/cam3/9.jpg       
  - platform: local_file
    name: cam3_history10
    file_path: /config/www/cam3/10.jpg           


  - name: cam4
    platform: mqtt
    topic: !secret frigate_cam4_topic
  - platform: local_file
    name: cam4_history1
    file_path: /config/www/cam4/1.jpg       
  - platform: local_file
    name: cam4_history2
    file_path: /config/www/cam4/2.jpg        
  - platform: local_file
    name: cam4_history3
    file_path: /config/www/cam4/3.jpg       
  - platform: local_file
    name: cam4_history4
    file_path: /config/www/cam4/4.jpg       
  - platform: local_file
    name: cam4_history5
    file_path: /config/www/cam4/5.jpg       
  - platform: local_file
    name: cam4_history6
    file_path: /config/www/cam4/6.jpg       
  - platform: local_file
    name: cam4_history7
    file_path: /config/www/cam4/7.jpg       
  - platform: local_file
    name: cam4_history8
    file_path: /config/www/cam4/8.jpg       
  - platform: local_file
    name: cam4_history9
    file_path: /config/www/cam4/9.jpg       
  - platform: local_file
    name: cam4_history10
    file_path: /config/www/cam4/10.jpg  

  - platform: reolink_dev
    host: !secret sebs_camera_ip
    username: !secret sebs_camera_uname
    password: !secret sebs_camera_pass
    name: Sebs Room
    scan_interval: 5


google:
             
  client_id: !secret google_calendar_client_id
  client_secret: !secret google_calendar_secret

zwave:
  usb_path: /dev/ttyACM0
  device_config: !include zwave_device_config.yaml

weather:

  - platform: darksky
    api_key: !secret darksky_key
    name: Weather Forecast
    mode: daily
    scan_interval: 720
    
  - platform: openweathermap
    api_key: !secret openweathermap_key
    mode: hourly

#panel_iframe:
#cloud9:
#  title: cloud9
#  icon: mdi:wrench
#  url: http://hassbian.local:8181/ide.html
 

#mqtt:
#
#  broker: !secret pi_ip
#  client_id: homeassistant-001


mqtt:
  broker: !secret narnia_ip
  client_id: homeassistant-001
  username: !secret mqqt_uname
  password: !secret mqqt_pass

input_boolean:
  fire_in_fireplace_tomorrow:
    name: Heat Down Tomorrow - Fire in Fireplace
    initial: off
    icon: mdi:fire
  fire_in_fireplace_now:
    name: Heat Down Now - Fire in Fireplace
    initial: off
    icon: mdi:fire
  sebastians_air_purifier:
    name: "Sebastian's Air Purifier"
    icon: mdi:fan
  sophies_air_purifier:
    name: "Sophie's Air Purifier"
    icon: mdi:fan
  mini_countryman_clima:
    name: "Car Klima"
    icon: mdi:air-conditioner
  working_from_home:
    name: "Working From Home"
    icon: mdi:home-account
  trash_needs_taking_out:
    name: "Trash Needs to Be Taken Out"
    icon: mdi:trash

#  mix_playlist:
#    name: Mix Playlist
#    initial: off
#  rock_playlist:
#    name: Rock Playlist
#    initial: off
#  pop_playlist:
#    name: Pop Playlist
#    initial: off
#  black_playlist:
#    name: Black Playlist
#    initial: off
#  classical_playlist:
#    name: Classical Playlist
#    initial: off
#  electronica_playlist:
#    name: Electronica Playlist
#    initial: off
#  kids_playlist:
#    name: Kids Playlist
#    initial: off
 
input_select:
  sean_last_zone_dropdown:
    name: Sean Last Zone
    options:
      - home
      - ToAndel
      - Andel
      - Lazarska
      - ToCenter
      - Work
      - SmichovskeNad 
      - ToWineFood
      - WineFood
      - ToHornbachP5
      - HornbachP5
      - FromHornbachP5
      - BioStore
      - Yoga
      - Billa
      - Posta
      - IkeaZlicin
      - ToP6
      - FromP6HomeHighway
      - FromP6HomeBackWay
      - ToHornbachP6
      - FromHornbachP6
      - HornbachP6
      - Airport
      - LittleGym
      - ParklaneValdejnska
    initial: home
    
  sean_location_dropdown:
    name: Sean Extended Location
    options:
      - Home
      - Left Home
      - Almost Home
      - Heading to Work
      - Heading to Center
      - Almost at Work
      - At Work
      - Waiting for Tram
      - Left Work
      - Heading Home
      - Heading to Andel
      - At Andel
      - Heading to Hornbach
      - At Hornbach
      - Heading to WineFood
      - At WineFood
      - At Billa
      - At Posta
      - Heading to P6
      - At Ikea
      - Driving
      - Traveling
      - At Little Gym
      - At Parklane Valdejnska
    initial: Home

  bosch_dishwasher_status:
    name: Bosch Dishwasher Status
    options:
      - Dirty
      - Running
      - Clean
      - Emptying
    icon: mdi:dishwasher

  living_room_last_preset_mode:
    name: Last Heating Mode in Living Room
    options:
      - 'none'
      - 'permanent'
      - 'temporary'
      
  miele_washing_machine_status:
    name: Miele Washing Machine Status
    options:
      - Empty
      - Wash Cycle
      - First Rest
      - First Spin Cycle
      - Second Rest
      - Second Spin Cycle
      - Finishing
      - Clean
    initial: Empty

  lg_washing_machine_status:
    name: LG Washing Machine Status
    options:
      - Empty
      - Starting Up
      - Wash Cycle
      - Spin Cycle
      - Clean
    initial: Empty

  active_heating_profile:
    name: Active Heating Profile
    options:
      - PROFILE_AUTO
      - PROFILE_A
      - PROFILE_B
      - PROFILE_C
      - PROFILE_D
      - PROFILE_E

  active_heating_profile_living_room:
    name: Active Heating Profile Living Room
    options:
      - LIVING_ROOM_AUTO
      - LIVING_ROOM_20
      - LIVING_ROOM_18

proximity:
  all_home: 
    devices:
      - device_tracker.seans_iphone_x
      - device_tracker.alena_s_iphone
      - device_tracker.sophie
      - device_tracker.sophies_iphhshshshs
    tolerance: 50
    unit_of_measurement: km
  sean_home: 
    devices:
      - device_tracker.sean_s_iphone_x
    tolerance: 50
    unit_of_measurement: km
  alena_home: 
    devices:
      - device_tracker.alena_s_iphone
    tolerance: 50
    unit_of_measurement: km
  sophie_home: 
    devices:
      - device_tracker.sophie
    tolerance: 50
    unit_of_measurement: km    
    
#device_tracker:
#  - platform: life360
#    username: !secret life360_uname
#    password: !secret life360_pw
#    filename: life360.conf

life360:
  accounts:
    username: !secret life360_uname
    password: !secret life360_pw   
  interval_seconds: 12
  show_as_state: [driving, moving]
  prefix: ''
  max_update_wait:
    minutes: 30

variable:
  dpd_variable:
    attributes:
      friendly_name: 'DPD'
      from: ''
      subject: ''
      body: ''
      date: ''
      icon: mdi:truck-delivery
    restore: true

  posta_variable:
    attributes:
      friendly_name: 'Posta'
      from: ''
      subject: ''
      body: ''
      date: ''
      icon: mdi:truck-delivery
    restore: true
      
  dhl_variable:
    attributes:
      friendly_name: 'DHL'
      from: ''
      subject: ''
      body: ''
      date: ''
      icon: mdi:truck-delivery
    restore: true
    
  gls_variable:
    attributes:
      friendly_name: 'GLS'
      from: ''
      subject: ''
      body: ''
      date: ''
      icon: mdi:truck-delivery
    restore: true

  living_room_last_temp_variable:
    restore: true

  last_motion:
    value: 'Not set'
    restore: true
    attributes:
      icon: mdi:format-list-bulleted-square
      name: 'Last Motion'

  last_door_window:
    value: 'Not set'
    restore: true
    attributes:
      icon: mdi:format-list-bulleted-square
      name: 'Last Door/Window'

  sophies_room_aqi:
    value: 'Unknown'
    attributes:
      icon: mdi:gauge-low
    restore: true
    
  sebastians_room_aqi:
    value: 'Unknown'
    attributes:
      icon: mdi:gauge-low
    restore: true

  sophies_room_aqi_description:
    value: 'Unknown'
    attributes:
      icon: mdi:gauge-low
    restore: true
    
  sebastians_room_aqi_description:
    value: 'Unknown'
    attributes:
      icon: mdi:gauge-low
    restore: true

  master_bedroom_aqi:
    value: 'Unknown'
    attributes:
      icon: mdi:gauge-low
    restore: true

  master_bedroom_aqi_description:
    value: 'Unknown'
    attributes:
      icon: mdi:gauge-low
    restore: true

  czechia_coronavirus_yesterday:
    value: 'Unknown'
    attributes:
      icon: mdi:bug
    restore: true
    
  czechia_coronavirus_new_yesterday:
    value: 'Unknown'
    attributes:
      friendly_name: 'New Cases'
      unit_of_measurement: yesterday
      icon: mdi:chart-bubble
    restore: true

  czechia_coronavirus_new_today:
    value: 'Unknown'
    attributes:
      friendly_name: 'New Cases'
      unit_of_measurement: today
      icon: mdi:chart-bubble
    restore: true

  dishwasher_last_door_open:
    value: 'Unknown'
    attributes:
      icon: mdi:door-open
    
cast:
  media_player:
    - host: !secret chromecast_ip
    
notify:
  - name: sean_alena
    platform: group
    services:
      - service: mobile_app_sean_s_iphone_x
      - service: mobile_app_alena_s_iphone
  - name: whole_family
    platform: group
    services:
      - service: mobile_app_sean_s_iphone_x
      - service: mobile_app_alena_s_iphone
      - service: mobile_app_sophies_iphone_6

speedtestdotnet:
  monitored_conditions:
    - ping
    - download
    - upload
  manual: true

alarm_control_panel:
  - platform: mqtt
    name: "Motion Sensors"
    state_topic: "paradox/alarm/state/3"
    command_topic: "paradox/alarm/cmnd/3"
    qos: 1
    availability_topic: "paradox/ctrl/state"
    payload_available: "Connected"
    payload_not_available: "Disconnected"
    payload_disarm: DISARM
    payload_arm_away: ARM_AWAY
    code: !secret alarm_code
  - platform: mqtt
    name: "Windows and Garage Door"
    state_topic: "paradox/alarm/state/2"
    command_topic: "paradox/alarm/cmnd/2"
    qos: 1
    availability_topic: "paradox/ctrl/state"
    payload_available: "Connected"
    payload_not_available: "Disconnected"
    payload_disarm: DISARM
    payload_arm_away: ARM_AWAY
    code: !secret alarm_code
  - platform: mqtt
    name: "Laundry Room Window"
    state_topic: "paradox/alarm/state/1"
    command_topic: "paradox/alarm/cmnd/1"
    qos: 1
    availability_topic: "paradox/ctrl/state"
    payload_available: "Connected"
    payload_not_available: "Disconnected"
    payload_disarm: DISARM
    payload_arm_away: ARM_AWAY
    code: !secret alarm_code


#    code: !secret alarm_code
#    code_arm_required: false
#    code_disarm_required: true

alert:
  garage_door_alena:
    name: Garage has been open for {{(as_timestamp(now())-as_timestamp(states.binary_sensor.ecolink_garage_door.last_updated)) | int //60 }} minutes
    done_message: Garage is closed
    entity_id: binary_sensor.ecolink_garage_door
    state: 'on'
    repeat: 
      - 10
      - 20
      - 30
    can_acknowledge: true
    skip_first: true
    data:
      push:
        sound:
          name: "EN-US-Daisy-Garage-Door-Open.wav"
        thread-id: "info"
    notifiers:
      - mobile_app_alena_s_iphone


  garage_door_sean:
    name: Garage has been open for {{(as_timestamp(now())-as_timestamp(states.binary_sensor.ecolink_garage_door.last_updated)) | int //60 }} minutes
    done_message: Garage is closed
    entity_id: binary_sensor.garage_open_sean
    state: 'on'
    repeat: 
      - 10
      - 20
      - 30
    can_acknowledge: true
    skip_first: true
    data:
      push:
        sound:
          name: "EN-US-Daisy-Garage-Door-Open.wav"
        thread-id: "info"
    notifiers:
      - mobile_app_sean_s_iphone_x
#    entity_id: binary_sensor.garage_door_zone_14

  front_door_alena:
    name: Front door has been open for {{(as_timestamp(now())-as_timestamp(states.binary_sensor.front_door_zone_1.last_updated)) | int //60 }} minutes
    done_message: Front door is closed
    entity_id: binary_sensor.front_door_zone_1
    state: 'on'
    repeat: 
      - 10
      - 20
      - 30
    can_acknowledge: true
    skip_first: true
    data:
      push:
        sound:
          name: "EN-US-Daisy-Front-Door-Open.wav"
        thread-id: "info"
    notifiers:
      - mobile_app_alena_s_iphone

  front_door_sean:
    name: Front door has been open for {{(as_timestamp(now())-as_timestamp(states.binary_sensor.front_door_zone_1.last_updated)) | int //60 }} minutes
    done_message: Front door is closed
    entity_id: binary_sensor.front_door_open_sean
    state: 'on'
    repeat: 
      - 10
      - 20
      - 30
    can_acknowledge: true
    skip_first: true
    data:
      push:
        sound:
          name: "EN-US-Daisy-Front-Door-Open.wav"
        thread-id: "info"
    notifiers:
      - mobile_app_sean_s_iphone_x

  sebastian_window_rain_warning_alena:
    name: Sebastian's room window is open and it might rain.
    done_message: Sebastian's room window is closed.
    entity_id: binary_sensor.sebastians_room_rain_window
    state: 'on'
    repeat: 
      - 5
      - 10
      - 20
      - 30
    can_acknowledge: true
    skip_first: true
    notifiers:
      - mobile_app_alena_s_iphone
    data:
      push:
        thread-id: "weather"

  sebastian_window_rain_warning_sean:
    name: Sebastian's room window is open and it might rain.
    done_message: Sebastian's room window is closed.
    entity_id: binary_sensor.sebastians_room_rain_window
    state: 'on'
    repeat: 
      - 5
      - 10
      - 20
      - 30
    can_acknowledge: true
    skip_first: true
    notifiers:
      - mobile_app_sean_s_iphone_x
    data:
      push:
        thread-id: "weather"

  sophies_window_rain_warning_alena:
    name: Sophie's room window is open and it might rain.
    done_message: Sophie's room window is closed.
    entity_id: binary_sensor.sophies_room_rain_window
    state: 'on'
    repeat: 
      - 5
      - 10
      - 20
      - 30
    can_acknowledge: true
    skip_first: true
    notifiers:
      - mobile_app_alena_s_iphone
    data:
      push:
        thread-id: "weather"

  sophies_window_rain_warning_sean:
    name: Sophie's room window is open and it might rain.
    done_message: Sophie's room window is closed.
    entity_id: binary_sensor.sophies_room_rain_window
    state: 'on'
    repeat: 
      - 5
      - 10
      - 20
      - 30
    can_acknowledge: true
    skip_first: true
    notifiers:
      - mobile_app_sean_s_iphone_x
    data:
      push:
        thread-id: "weather"

  trash_needs_to_be_taken_out:
    name: "It's trash day and the trash still needs to be taken out!"
    entity_id: binary_sensor.trash_emergency
    state: 'on'
    repeat: 
      - 60
    can_acknowledge: true
    skip_first: true
    notifiers:
      - mobile_app_sean_s_iphone_x
    data:
      push:
        category: "trash"
        thread-id: "info"

  basement_sliding_door_sean:
    name: "Basement sliding door is open"
    name: Basement sliding door has been open for {{(as_timestamp(now())-as_timestamp(states.binary_sensor.basement_sliding_door.last_updated)) | int //60 }} minutes
    done_message: Basement sliding door is closed
    entity_id: binary_sensor.basement_door_open_sean
    state: 'on'
    repeat: 
      - 1
      - 4
      - 5
      - 10
      - 10
      - 15
    can_acknowledge: true
    skip_first: true
    notifiers:
      - mobile_app_sean_s_iphone_x
      
    data:
      push:
        thread-id: "info"


  basement_sliding_door_alena:
    name: "Basement sliding door is open"
    name: Basement sliding door has been open for {{(as_timestamp(now())-as_timestamp(states.binary_sensor.basement_sliding_door.last_updated)) | int //60 }} minutes
    done_message: Basement sliding door is closed
    entity_id: binary_sensor.basement_sliding_door
    state: 'on'
    repeat: 
      - 1
      - 5
      - 10
    can_acknowledge: true
    skip_first: true
    notifiers:
      - mobile_app_alena_s_iphone
    data:
      push:
        thread-id: "info"

input_number:
  living_room_last_temp:
    name: Last Temp - Living Room
    min: 5.0
    max: 25.0
    step: 0.5

shell_command:
  update_avnodehome_data: !secret avnodehome_update_cmd
  update_avnodehlubocepy_data: !secret avnodehlubocepy_update_cmd
  roll_frigate_history: !secret roll_frigate_command

browser_mod:

display:
  - platform: fully_kiosk
    name: Kindle Fire Kitchen
    host: !secret kindle_kitchen_ip
    password: !secret kindle_kitchen_pass
  - platform: fully_kiosk
    name: Kindle Fire Master Closet
    host: !secret kindle_master_closet_ip
    password: !secret kindle_master_closet_pass

remote:
  - platform: harmony
    name: harmony
    host: !secret harmony_ip

rest_command:
  record_human_front: 
    url: !secret human_record_front_url
  record_human_back: 
    url: !secret human_record_back_url
  record_human_left: 
    url: !secret human_record_left_url
  record_human_right: 
    url: !secret human_record_right_url

fan:
  - platform: xiaomi_miio
    name: sebastians_room_air_purifier
    host: !secret xiaomi_air_purifier_sebastians_room_ip
    token: !secret xiaomi_air_purifier_sebastians_room_token
  - platform: xiaomi_miio
    name: sophies_room_air_purifier
    host: !secret xiaomi_air_purifier_sophies_room_ip
    token: !secret xiaomi_air_purifier_sophies_room_token
  - platform: xiaomi_miio
    name: master_bedroom_air_purifier
    host: !secret xiaomi_air_purifier_master_bedroom_ip
    token: !secret xiaomi_air_purifier_master_bedroom_token
    
evohome_rf: 
  serial_port: /dev/ttyUSB0
  packet_log: /share/packets.log

timer:
  bosch_dishwasher_emptying:
    duration: '00:03:00'

dreamscreen:
  devices:
    - living_room_tv:
        address: !secret dreamscreen_ip

bmw_connected_drive:
  name: 
    username: !secret mini_uname
    password: !secret mini_pw
    region: rest_of_world

airvisual:
  api_key: !secret airvisual_key

withings:
  client_id: !secret withings_client_id
  client_secret: !secret withings_consumer_secret
  profiles:
    - !secret profile_1
    - !secret profile_2
    - !secret profile_3
    - !secret profile_4

panel_custom:
  - name: zwavegraph2
    sidebar_title: Z-Wave Graph
    sidebar_icon: mdi:access-point-network
    url_path: zwave

influxdb:
  host: a0d7b954-influxdb
  port: 8086
  database: !secret influxdb_db
  username: !secret influxdb_uname
  password: !secret influxdb_pw
  max_retries: 3
  default_measurement: state

synology_dsm:
  - host: !secret synology_ip
    username: !secret syn_uname
    password: !secret hass_pass

home_connect:
  client_id: homeconnect_client_id
  client_secret: homeconnect_client_secret

device_tracker:
  - platform: iphonedetect
    consider_home: 60
    interval_seconds: 6
    new_device_defaults:
      track_new_devices: true
    hosts:
      seans_iphone_x_ping: 10.10.10.26
      alenas_iphone_6_ping: 10.10.10.27
      sophies_iphone_6_ping: 10.10.10.13